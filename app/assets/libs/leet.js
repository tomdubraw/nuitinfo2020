class Leet {
    constructor(replacement) {
        this.replacement = replacement;
        this.regex = new RegExp(`(${Object.keys(replacement).join('|')})`, 'gi');
    }

    replace(string) {
        return string.normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(this.regex, e => this.replacement[e.toLowerCase()]);
    }

    transform(element = document.body) {
        for (const e of element.childNodes) {
            if (e instanceof Text) {
                e.replaceData(0, e.length, this.replace(e.data));
            } else {
                this.transform(e);
            }
        }
    }
}

function r(array) {
    return array[Math.floor(Math.random() * array.length)];
}

const url = new URLSearchParams(window.location.search);

if (url.has('leet') && url.has('full')) {
    new Leet({
        a: r(['4', '/\\', '@', '^', 'aye', '∂', '/-\\', '|-\\', 'q']),
        b: r(['8', '6', '13', '|3', 'ß', 'P>', '|:', '!3', '(3', '/3', ')3']),
        c: r(['(', '¢', '<', '[', '©']),
        d: r(['[)', '|o', ')', 'I>', '|>', '?', 'T)', '|)', '0', '</']),
        e: r(['3', '&', '€', '£', 'є', 'ë', '[-', '|=-']),
        f: r(['|=', 'ƒ', '|#', 'ph', '/=']),
        g: r(['6', '&', '(_+', '9', 'C-', 'gee', '(γ,']),
        h: r(['#', '/-/', '[-]', ']-[', ')-(', '(-)', ':-:', '|~|', '|-|', ']~[', '}{', ']-[', '?', '}', '-{', 'hèch']),
        i: r(['1', '!', '|', '][', 'eye', '3y3', ']', ':']),
        j: r(['_|', '_/', '¿', '</', '(/', 'ʝ', ';']),
        k: r(['X', '|<', '|{', 'ɮ', '<', '|\\“']),
        l: r(['1', '£', '1_', 'ℓ', '|', '|_', '][_,']),
        m: r(['|v|', '[V]', '{V}', '|\\/|', '/\\/\\', '(u)', '(V)', '(\\/)', '/|\\', '^^', '/|/|', '//.', '.\\\\', '/^^\\', '///', '|^^|']),
        n: r(['^/', '|V', '|\\|', '/\\/', '[\\]', '<\\>', '{\\}', ']\\[', '//', '^', '[]', '/V', '₪']),
        o: r(['0', '()', 'oh', '[]', '¤', '°', '([])']),
        p: r(['|*', '|o', '|º', '|^(o)', '|>', '|"', '9', '[]D', '|̊', '|7', '?', '/*', '¶', '/*', '|D']),
        q: r(['(_,)', '()_', '0_', '°|', '<|', '0.']),
        r: r(['2', '|?', '/2', '|^', 'lz', '®', '[z', '12', 'Я', '|2', 'ʁ', '|²', '.-', ',-', '|°', '\\']),
        s: r(['5', '$', 'z', '§', 'ehs', 'es', '_/¯']),
        t: r(['7', '+', '-|-', '1', '\']', '[\'', '†', '|²', '¯|¯']),
        u: r(['(_)', '|_|', 'v', 'L|', 'µ', 'J']),
        v: r(['\\/', '1/', '|/', 'o|o']),
        w: r(['\\/\\/', 'vv', '\'//', '\\\\`', '^/', '(n)', 'V/', '\\X/', '\\|/', '\\_|_/', '\\_:_/', 'Ш', 'ɰ', '`^/', '\\./']),
        x: r(['><', 'Ж', '}{', 'ecks', '×', ')(', '8']),
        y: r(['7', 'j', '`/', 'Ψ', 'φ', 'λ', 'Ч', '¥', '\'/']),
        z: r(['≥', '2', '=/=', '7_', '~/_', '%', '>_', '>_', '-\\_', '\'/_'])
    }).transform();
} else if (url.has('leet')) {
    new Leet({
        a: '4',
        e: '3',
        l: '1',
        t: '7',
        s: '5'
    }).transform();
}